# server {
#     listen 80;
#     server_name 3.108.65.30; # Consider using a domain name here if one is available

#     # Access logging for favicon requests is usually disabled.
#     location = /favicon.ico { 
#         access_log off; 
#         log_not_found off; 
#     }

#     # Serve static files directly from Nginx (recommended)
#     location /static/ {
#         # CRITICAL: This path must match the COLLECTSTATIC location in your Django settings.
#         root /home/ubuntu/django-ecommerce; 
#     }

#     # Pass all other requests to Gunicorn via the socket
#     location / {
#         # Standard headers that were in the missing 'proxy_params' file.
#         # We include them directly here to ensure the configuration works without file issues.
#         proxy_set_header Host $host;
#         proxy_set_header X-Real-IP $remote_addr;
#         proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
#         proxy_set_header X-Forwarded-Proto $scheme;

#         proxy_pass http://unix:/home/ubuntu/django-ecommerce/gunicorn.sock;
#     }
# }

server {
    listen 80;
    server_name 3.108.65.30; # Use your public IP or domain name

    location = /favicon.ico { 
        access_log off; 
        log_not_found off; 
    }

    # Serve static files directly from Nginx (recommended)
    location /static/ {
        root /home/ubuntu/django-ecommerce; 
    }

    # Pass all other requests to Gunicorn via the socket
    location / {
        # Standard headers
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;

        # CRITICAL CHANGE: Pointing to the new socket location in /var/run/
        proxy_pass http://unix:/var/run/gunicorn/django-ecommerce.sock;
    }
}